package hackersrank;

import java.util.TreeSet;

// https://www.geeksforgeeks.org/maximum-subarray-sum-modulo-m/
public class MaximumSubarraySum {
    public static void main(String[] args) {
/*
        long[] a = new long[]{1063543500,1777948292,1514394726,1615925574,1672782621,1417622055,1674776369,223381793,15088315,494060001,1532732042,512878894,1180424874,2031346491,647570386,407812375,2034771219,1484649266,262693622,109957932,653062971,772852010,1313605694,1151339353,1450122514,1817299694,1180146806,945102306,1577738406,559147281,936883534,493798257,189611924,303794611,2109723830,1862394545,1721416665,1637016550,2085776337,1736504980,2131076550,1471024730,101900225,1164017776,1354887572,749470611,1571830150,1242175142,86636228,1834523771,1352133073,739699198,459892132,518255119,1891038550,1910014646,188071164,923701707,707633303,1765809569,1482848987,1644516836,112124177,1672460911,1948311446,74364358,1387371807,1522244462,1711380908,1325664495,1111265793,1694973809,649205576,1213166018,711507936,2004093147,1962636628,135854437,1098784640,2049272855,1970378207,303434064,641488404,282786691,821689182,385043305,45317688,1009760345,1308745012,752950990,628086265,644110350,249984177,740210441,169087612,50811974,814574799,1556459418,1573056435,378472058,734640264,536838580,2073445866,1383845839,1750004597,637470154,1240455337,1565157576,773324590,191756328,1466946782,596219149,495190392,2108435185,879005839,1316879573,345994841,924323526,179156270,1654739852,1677274515,807242534,151366554,1927258691,1547452975,320454165,1978070664,214544125,1876913583,1403643450,593016182,464070198,1940482029,518978399,1847916037,1543002977,1156448552,940887725,960676904,1929773142,1132644053,280140037,378508642,1627834444,241091573,1257514480,797230368,587086414,34354357,976386637,94342617,1711628871,1783629171,245709170,1491403913,1183598497,566163335,1321990928,1398142621,295593269,578150729,1991158802,759663466,371149110,362653552,460095854,1914152086,1519102104,1400983579,727345342,1301391597,386143983,1007485378,1679900238,2013978426,1248576951,789931069,663725145,1835663364,824285425,1640111782,1930005980,388430647,1276257304,28231502,1879834559,312372152,594394836,1054341838,1710514772,889988104,1632492566,1554189925,1649651569,2003641675,1916843476,2109747423,1770310113,1288461931,1363247353,350171806,442369879,1749391335,1357657183,2122270116,1615886112,458750485,764717536,132127608,146930200,1589002960,1772239389,2076936180,1977433606,901013044,2105167681,1709784516,1213385195,552078868,616642705,776416318,1442066971,101651623,183122594,944234891,2105293297,2099966070,906498665,1728119761,1240944352,122262369,2078291566,1683314231,1871653703,1288465101,1658100698,1340056166,1747215585,275334586,1472183774,1894145785,1864337545,1096939514,1823598316,1694287503,1997952558,1781282348,1256588370,1063854104,185877567,1873231075,1840270422,1627944537,1974882697,2023393015,424695779,1932692345,1975875436,1331194444,1513328458,1069336140,1453456812,1444136375,605166722,1177626867,585117827,115783771,370199384,184849764,391118356,1842383157,2078995548,107972253,791839023,1755110215,1802259755,642307932,1388908914,911364476,1706162035,1574786480,637111902,1398948808,1055247368,464510950,1274858175,1479943146,249719647,1103249962,663653941,1763048104,25102453,2117110753,1059700830,630269174,1147253971,1644818657,746052945,1517453354,1829668420,1137171300,1212352863,1761180319,1245143552,2004191885,1368806885,899919658,499016168,610232150,1811284134,57694554,37534981,300912387,1456643362,1092782348,765423337,584017888,425241845,1015142983,1687267849,1088895786,630707438,1712370302,1058522890,1690408267,195155827,58293212,1187743275,941208771,1575746565,869928046,2078380071,640615779,483624716,1176039974,497324015,1852431600,2075959632,996340182,315180101,1739760117,1054034736,352715081,2040672503,363194449,1445497428,658612191,947212336,1870739273,1673755173,486996536,812151410,156978962,51883189,1870674299,1847387229,247039016,1928967510,887646855,1188247786,1357230426,1757574901,1119144208,1997846205,93715968,147700534,347686571,1946147568,76176517,1344026753,113844020,1815936633,250577840,466559101,1709125487,613772288,1912056528,220254030,1560984623,1635312152,1894009202,2047981158,299979913,2050988164,2099864347,23170563,1750891744,199419714,1952138072,491054950,1387667499,1161884850,101146202,359328059,1012247406,194862170,507028592,1359933976,2141009737,583205108,556477080,107370108,251658092,807054919,573929208,1960783578,1420827206,338502088,33553959,834328180,1973814239,1927563161,734825690,126310504,1831067676,687206388,149481066,1434475771,886626101,2101619138,1925530720,126809951,1116020339,2026676922,486138009,2128267744,74055443,993166600,1340718071,67581531,1576371707,1897195151,174951638,1828029798,556766421,748880846,1641329728,1977593627,1087382933,1674883686,664438158,913713523,1454963198,1399263847,1040024026,1138547225,2086470234,1189505092,425539347,825612686,1143640581,203586419,952422637,112177271,82779692,1438560645,92961366,156835134,284243597,1433679436,224416664,1860615303,1183390938,399368301,1541161453,1740157359,1148249146,1035007532,1570267337,88148430,562407569,87221846,1001861953,2017370767,1486485693,2041885978,1008434343,1425472278,1083907421,1433973690,103601316,80064353,1637560108,1056023952,192241623,1720339799,347100948,285202988,1877174932,631344544,1718882424,2101591595,344476199,754789713,353476247,1885637651,347463423,1501725393,773161534,1917730759,1589873822,1335569102,2004952605,444252126,1205456220,1343954649,338654456,66406915,621943278,1422561876,1500380604,725544593,1502626229,990457063,1781568544,1694867851,563313213,2128669492,1980070839,293004496,612530387,1551469614,247112442,957006585,158775678,600588688,695160587,506239101,2102314080,1468322120,276486211,1544704254,656407574,133955167,1988956379,1861863793,1477909815,180127186,1928270707,2099853093,1602689062,1281167662,677914037,957831642,124141076,311998933,505215844,687454288,293184776,337803034,980458783,905715162,1889272647,1227571224,1862721747,2048048325,1828159912,410398685,406803777,1782990343,1878720805,683289987,1180210948,387644730,817245154,1021683679,102024874,147671320,1201810864,2030295581,100040764,657016277,1163979594,777954801,1614847918,1288120670,1089953733,2120063762,1975574957,1383138508,310383147,808550092,141370021,52172146,2036121315,2004091767,2100220470,1716797578,267006804,359540598,1352304273,2145727608,1042830584,385031572,385888689,1860075737,1406715250,487913562,2007747057,461042466,370725494,2107787820,1118058742,1534705088,738258972,585423012,675342109,1828212704,558003125,503433417,1063867563,868386271,1311983508,1205237584,920558416,1200621175,1061845702,873295237,769935104,1328852505,1232835834,2122239376,1327096464,128182770,359787300,1712985152,1988258506,1766502549,53415066,1848521914,80061366,424140559,1808826086,1198120108,1958845646,399601409,1783543119,486704106,80330465,194062595,990137523,1144198027,1062448865,154637382,201951962,1983007281,1355258556,1263797664,708818869,2125193660,445166520,1941654703,2099949387,1772262984,2069837472,312253038,1337764487,1910612329,2078755587,1391179552,1611650595,11333304,1815320111,1272993032,1209453411,1626682108,1672594440,845512881,2113386214,1752924904,1039575475,956040088,749639283,2102024340,1110677469,951591244,1937547972,318452377,67905259,498883192,296162388,513071779,293054246,248628126,137851114,215408069,560881164,1475615600,2126020398,492153102,719311504,1590187344,503486405,387147966,715696727,1712939816,2013830073,240807518,410969048,1979732638,1993732422,1450544523,788289077,595888056,1405085214,1898966546,1547479299,1195149537,69935274,1615384558,1694032728,366097661,2128456336,1987086974,614725786,118823801,55011394,1175606949,1594439400,33548143,1667760050,166267255,1623735486,23762807,553415220,191948564,1736702622,419761645,432756082,188021,252010634,279004855,1450732543,1040299711,874892910,708334108,791782608,274888560,1903483644,861717881,1890273117,1450032724,1227815541,1871245804,1289636049,1842541326,1990069604,1344647442,870664627,1437025356,1378195585,390941028,1603292610,854447422,414703834,9224182,1046395986,3922807,428985826,1479152067,4110828,680996459,1758156921,1454843370,1721296169,485566182,15693830,365595128,760454741,1919177473,1227313008,503244210,1221726548,307644900,227006365,363878948,2702578,69592321,1708526390,873367204,1506617676,939238326,1264308231,962426637,1793685747,1679012065,971650818,692598084,1682934871,1400636643,24266502,1687045698,2081633102,1782423422,994405420,1655445622,120505955,1010099249,2021040750,880960696,781793073,1100870109,1384204905,2003519621,1408515009,1611211269,219914920,1411217586,1680803589,1928441309,137101141,1039937616,720195986,1401409371,2002364253,366398085,932937787,826531422,1058996168,468389010,79684417,1083262670,7951059,13833870,718202443,1002356478,1669279491,838708398,2012455726,1542836592,1719669093,646765151,496223053,956390349,502801123,1904738061,420117969,722716042,1168471998,2100921558,503673703,1305573138,993375525,1223869688,559498860,848256129,1590267772,1492436647,1674787551,501780292,1960825656,1754471967,1585042961,1968776714,1768305836,155761755,823649544,1290101678,994470152,688621621,685454622,566655596,1335386771,1181677674,1523045944,1838187893,938932086,1943163913,413420287,2107404083,1896601822,917093989,1265493572,742493698,2140963676,1824992431,1590749827,1583747800,1169945429,1118053729,2085528091,983287436,725042047,1523087403,804580502,345864234,1678849157,1628230045,1635965911,525835661,169368017,173936884,1092491256,1504754788,1355614557,468053552,1195459032,147062994,263733816,1608879318,106983428,12851989,378489658,1372476999,755345686,371969686,1049985782,198611864,1955717485,72447562,1316665592,1893761927,1055734998,2041707638,1269365681,1860315499,240088223,800731189,1341061895,1876054134,1326566849,1510429911,2049991017,271574457,867701050,1258121926,739628008,2063160082,1405184919,1003361823,1524555751,1512168347,1016213811,1903045409,737161697,1771559496,127531446,1787147478,1970171360,2083248930,1859595040,1139353303,1829527208,767846389,1033577293,951409240,480678239,1273665515,1752140428,1821740133,1002236000,931223629,1184686395,904743369,1202798085,2052387445,15381646,1942426092,1968063878,1420566564,798304266,1345135980,785251262,1814518076,1100697740,1522412959,1438593923,1228229185,1162076788,1261281634,1163994466,874188179,253151289,846038025,1642034567,1286728581,1797447264,2122712805,412910447,1402104044,1796969289,1415146447,185844024,834172036,172406167,1388642108,739075832,187787812,1183584551,559656061,1608354375,1981888816,1904792040,246121989,1648923243,858006132,1768534947,940033517,2086235316,783128086,53831503,1102746134,1657316265,306982791,1948784158,1151867183,1593711371,1598747774,1127096340,2006621817,853368169,776581980,1274284615,1039212192,1610754015,1446690781,280370651,202346198,1634478592,1463955201,762002258,1095349319,1298360368,519310650,1341471307,799799962,1377316781,962522605,1739833478,1316068448,1745650690,1793664980,271330933,1255483306,2100647770,72631443,259866841,1546875492,1671379216,1386963180,1406013661,377263736,16061511,532814627,1416475927,1626815526,1979505408,1696846577,1829161723,1466500351,1013318129,443680333,414366021,164194848,962990982,1755837327,963994809,192824114,570876283,556344638,1508892561,169043325,202525970,1780223494,1424526630,155690091,1852854936,1684393470,1702565583,1376750503,923873001,961095595,1754014238,939934512,1493910221,1023006516,419266389,1325931980,572369444,100944463,644948683,1585687572,544624795,1059314703,1749882419,1507615776,667668382,566393579,1700439889,1238544664,1122738216,1061848802,1407587988,1325264185,694588647,684630970,1480954276,399959934,221540791,1036036210,1776710436,1145413792,1997131804,1383241025,2085348303,1343558376,258763892,357131043,522006708,831133335,458075505,1166955390,269337258,1002700300,78786444,2019219676,362832427,746454825,438129606,2063272316,1984999489,1560867821,977637469,1245103828,738648358,1672226115,1929734797,72118985,2072186048,3791940,1108155194,1701412835,1149205731,957803349,937170211,1087070385,153878076,1195934102,1444201427,675884783,2027067436,1902276931,1842840172,148921045,757493582,1921626616,20657072,1120326009,520597792,458786677,1036114676,358113632,2019654497,2013752144,1603217460,610819206,1538494610,1385468608,682938190,1463197009,1389260547,1791093383,1017126195,390982629,601413083,1954296405,1478053013,755291159,1002746858,774770791,1431175941,882330645,529564074,1126532465,1031251689,1287057655,900675432,1051908760,259900015,1421273223,1510695436,1296014690,1779386855,1382866284,1162283185,1235120666,1993685490,553294146,473105625,529140031,2016491154,1862366172,172749766,886133700,105865152,774162848,692946456,1583918165,1529454006,1695693313,211205307,813146299,430540309,740769380,1939678763,1461791997,2027827035,692870546,366217108,140243401,2114143768,1876912543,1436258091,1746046974,1112295179,451057627,833683991,958497020,1004351773,1306789616,1487637050,873359278,1021672139,1660386815,1759492978,1127537290,287066015,304955785,563971806,1816520020,2000649098,775177113,482182670,283705758,1515946492,274377784,1745497755,1396289878,967248329,2111714862,1536533279,933908449,1841143757,825307721,532471774,805955287,1276365347,1366155765,1764452306,133233471,525461732,1104605707,1006592749,1547133870,617508874,618602078,527187511,904574888,923557862,1091159317,573611259,776723311,1866336429,1055793929,1060429069,1234799272,1330171712,658443175,483605502,149936393,622674388,2020138780,1083844841,316334496,697962852,1616316614,1122289782,1974328198,834988730,739258439,2107561669,1360450461,1843864146,966670769,760100682,313889371,1585272846,1287288193,1218464258,361347059,230963861,1792075516,1138070370,2097300289,700385796,51015790,1184615912,2030557508,709458964,1668221413,33010252,1332133351,1540876544,1116855092,1648467847,91355747,585688057,623273980,2065683945,1420676787,1362532419,2025761965,633643599,1058912916,844949085,1393744281,1372802286,282738282,533548825,443782895,644085340,764512685,88374762,1782155709,714329325,788760558,1833171498,1898945236,671834417,395146813,1419683001,704844668,1727280164,813075896,1821699759,1228264362,904431643,259904167,1851538341,822631939,1680580953,1066587111,700910255,166740904,2125500026,1545859339,1560485184,1350818663,1828597620,2094034008,1794601557,325199311,711063044,1882976319,2107355020,1425392368,524253228,1793042869,1176853955,1196087644,40706034,449053307,1900932311,1767986197,1262129203,1575148421,848766910,19077197,1835052587,552821602,841709135,1368149892,1619408713,1542619389,1534890795,1597425090,940995079,947892330,800760105,622109050,894442689,447878013,947308360,1605505732,183370683,907179731,883414451,707623910,552738952,2060268405,1903711553,593444985,361838064,1657160215,213947533,1623967266,1084824987,1062714442,1643044462,772393926,1615536043,337269948,2140543817,1087461107,1879889336,1527950963,537402549,673400766,328359644,1338162653,1295509815,1222802332,1786040665,95334526,680824415,1969411348,1002514257,1564238865,529551609,1555253208,1477023621,285779514,1214544,1838861684,1942939728,215162076,1315345301,880281067,1277876517,810906114,1652674992,745928911,1148176061,1645735160,1833390018,880581748,1026202474,223308918,1553982513,1354562117,1561471570,702008679,429880800,1200028586,797343205,1110705214,1021956285,1799857461,527460430,1551507894,1207627020,2004484050,1837287407,1208841563,1695862086,1632743486,1424003638,863723738,365540904,554396506,1674629852,2018215895,1300325416,675322264,1516467406,986231785,1555904012,395186231,1209540702,962402876,1749748347,623528623,1664411555,32145498,1823557209,314271111,1142850711,698029845,2114128571,1670311140,102054090,1174271942,1527311542,1939341496,235629856,1075689979,1424601334,1659633493,1939413716,1790142237,66546350,1466559919,1660874484,1366871765,2141882183,1029858241,205619902,1550302546,1425044472,1415160603,365221773,1027309170,2038689226,2029633327,1059454668,1714762786,196420789,54821730,265308982,163065711,1725132870,367363072,1337337652,1104960763,159220919,1572967507,33167093,1583822252,1085117351,1972580808,1226480841,1151663700,1291657079,739871676,371051817,1286055613,1769729916,576671718,688874510,1047290739,1991832320,1054096282,2074599909,1883037897,936245961,986570928,1450317034,1132666749,1041392657,1715626016,1295732460,619041878,2082989087,485586463,1724002640,94726357,2058553970,1757169732,1678548609,996187672,1582266892,757545801,367724,726440322,1497417476,371419540,2012495934,1119663743,948091257,553886795,19470834,792439928,1607983076,2094070742,527994177,396745388,933158021,1978311210,1529412137,1974550677,1546453577,677660948,446108907,1481959015,1163247410,22627898,1576685372,1074317731,1779797630,1107750332,2070505403,1214580873,1865296132,2070873126,1941021194,1215229959,294809017,1806033479,187410053,1242900273,212436625,206880886,2035340200,1820419700,153467979,415850728,69681440,1086625999,246678290,1599093576,913693028,1793131866,129270875,1359801934,1127607233,1292518284,1382429831,556808956,219352367,1014743812,1664559287,142374121,81841036,1382371770,65763598,2022862229,450118080,360572614,1681412059,637528132,1603472886,1893848683,844409018,1491329437,1566784735,997876996,1907180165,1636466174,2084502995,6374806,1088076101,850712374,1799506671,1217346975,63030659,779630255,362381610,1445460489,1336439210,581733976,312720653,853514848,724108096,394561688,88402969,789871693,269940269,538521048,1150444306,1951352327,1176049180,606433543,1697717362,2020458197,2097762980,1117018448,870851544,1857459496,606000973,807870890,1863834301,1694077073,1658583263,1515857323,763940399,1721613921,148003930,1126322008,1019590762,1484443139,1708055984,1332311414,190474339,284680431,1726873101,278877307,1074552124,1996813369,817398355,77512781,1800682048,1993447534,683946324,1350915761,1866422082,634225655,320450560,589789977,344201502,926451532,1397660867,60552154,473044956,908760481,1576409476,1236985354,482890754,1724413405,215823713,1502481515,1061372896,1923879696,687309280,1251847234,61076479,266698732,1530724540,1135628602,116028453,200639246,1213141382,1916710500,46603131,1897087705,1120142612,1913025212,383829711,1440593171,355331541,728031212,219561054,1752992407,788583365,692606009,514269239,217509193,1929591362,997159992,1941922597,2145415074,352157858,855811844,1921811122,1039467137,2107659077,1982887600,1306165869,1490899969,971032553,1422194321,1691539214,36690286,1191421172,1738142345,1933777991,164080135,1503683908,170124053,1604673305,1859015448,898155265,1824234358,1464524206,1686738629,369356718,1978793445,1904247821,151464431,828469788,1698686770,149395856,1180627646,407014965,2071206977,72611134,367190394,1906610928,1378777002,1858090362,730159832,653487674,1402145927,766850118,1844908845,992804623,553144460,2008988979,349004883,723268512,1466178635,60536682,1621423776,1142929344,1525060888,1160678757,1512286061,1356370684,917442929,1663750491,37356823,468646050,1813146347,1217984468,875661015,1736869675,1290595602,1242851408,1495996955,521888955,953458121,78673138,1175376629,208120399,845523255,872801825,1200925022,1398667714,734307156,1549929904,2121936226,53002142,1610466585,1595876353,1195931486,988043824,609071461,560733898,196930859,1526514390,77000741,234287682,1995160439,1890147087,1452272149,723337805,1479533113,595384102,1966189212,828046419,1117273057,772163684,906719557,145166037,980284083,1752242811,1017967861,33725456,1003426877,1752275016,1583655359,977879454,1805277158,1046638295,426272158,853724995,2034682119,1035343619,1414458892,84129329,414374360,1491459632,318417010,262051150,1234123070,1770689159,985388955,566172535,218589612,804094518,1394218953,1335862668,1576258202,153454861,1481028704,409058636,1905697672,351512917,442784091,761640900,2103787932,2026439449,1739520353,1761581441,925594095,18308862,467822787,812792565,1053652480,1882281679,896921894,1468026839,1226257662,1215338903,1730077989,312897084,838544413,567983295,879069618,1057134025,1372077812,125804922,245513044,800852365,279259783,1726541748,1209911000,37473806,2078054664,1652695090,799114705,2034358947,1531650890,391151409,1648456740,309761337,409460270,2116279526,1122553901,1463112750,1851077556,2019475794,783655940,929851570,1087331049,366250280,1242748653,1925875461,934233574,2121818270,835525837,158827738,100139543,1081038881,959680102,379399325,660096980,22107454,416873130,590667995,1674802543,1215987834,477543293,1058969785,1607139242,2126000032,1368731121,2016599512,2094795910,343801373,1332228613,1798389817,215793519,2115884552,580757738,1303124567,334651184,1823506390,1081516379,1268884757,1797841011,1917042216,1427712494,1897980554,850597448,239908948,129896230,1510694427,262016401,546769360,2101362421,1936818943,1762757193,431422065,848305079,1222412787,409938449,69552551,1091528650,357250710,413353924,276273614,8156878,629147442,244674517,588914616,1932272008,579325700,264937357,866304738,1848210457,2062778368,635863305,1128439302,1813275273,1486460752,1368348249,1943171502,849671530,1630364649,342457213,803550302,1419699944,2105214406,1234972367,120521374,1180143544,1644910815,190073925,124188545,2002161524
        };
        long m=2139264877;
*/
        long[] a = new long[]{3,3,9,9,5};
        long m=7;
        TreeSet<Long> tree = new TreeSet<>();
        tree.add(a[0]);
        long l1=System.currentTimeMillis();
        int length = a.length;
        long sum=0;
        long prefix = 0;
        long max=0;
        for(int i=0;i<length;i++){
            prefix = (prefix+a[i])%m;
            max=Math.max(prefix,max);
            Long lon = tree.ceiling(prefix);
            if(lon!=null){
                max =   Math.max(max,(prefix-lon+m)%m);
            }
            tree.add(prefix);
        }
        long l2=System.currentTimeMillis();
        System.out.println(l2-l1);
        System.out.println(max);

    }

}



